// Prisma schema for Shopify MCP session storage
// Using PostgreSQL with Prisma 5.x

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Session {
  id                String   @id @default(uuid())
  shop              String   @unique
  accessToken       String   // Encrypted before storage
  scope             String?
  apiKey            String   @unique
  createdAt         DateTime @default(now())
  isOnline          Boolean  @default(false)
  state             String?
  
  // Billing fields
  plan              String   @default("free") // "free" | "starter" | "pro"
  usageCount        Int      @default(0)
  usageResetDate    DateTime @default(now())
  subscriptionId    String?
  
  @@index([shop])
  @@index([apiKey])
}
