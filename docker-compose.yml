version: '3.8'

services:
  shopify-mcp-server:
    build: .
    container_name: shopify-mcp
    ports:
      - "3000:3000"
    environment:
      # --- General ---
      PORT: 3000
      
      # --- Security (Required for SSE/n8n) ---
      MCP_SERVER_TOKEN: ${MCP_SERVER_TOKEN}
      
      # --- Shopify OAuth (Required for App Install) ---
      HOST: ${HOST} # Public URL (e.g. https://mcp.yourdomain.com)
      SHOPIFY_API_KEY: ${SHOPIFY_API_KEY}
      SHOPIFY_API_SECRET: ${SHOPIFY_API_SECRET}
      
      # --- Legacy / Single Tenant (Optional Fallback) ---
      SHOPIFY_SHOP_DOMAIN: ${SHOPIFY_SHOP_DOMAIN}
      SHOPIFY_ACCESS_TOKEN: ${SHOPIFY_ACCESS_TOKEN}
      
    restart: always

# Note for Coolify:
# 1. Add this repository to Coolify.
# 2. Set the 'HOST', 'SHOPIFY_API_KEY', 'SHOPIFY_API_SECRET', and 'MCP_SERVER_TOKEN' in the "Environment Variables" section of the project.
